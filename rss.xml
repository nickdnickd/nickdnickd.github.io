<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Nick D Blog]]></title><description><![CDATA[A blog covering how to use programming to address simple questions.]]></description><link>https://nickdnickd.com</link><generator>GatsbyJS</generator><lastBuildDate>Mon, 19 Apr 2021 01:12:15 GMT</lastBuildDate><item><title><![CDATA[IRS v BTC]]></title><description><![CDATA[UPDATE TurboTax has now pulled Coinbase from the list of providers for CSV uploading. While less confusing, the workaround I created no…]]></description><link>https://nickdnickd.com/crypto-taxes/2021-3-1-Crypto-Taxes/</link><guid isPermaLink="false">https://nickdnickd.com/crypto-taxes/2021-3-1-Crypto-Taxes/</guid><pubDate>Mon, 01 Mar 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h3&gt;UPDATE&lt;/h3&gt;
&lt;p&gt;TurboTax has now pulled Coinbase from the list of providers for CSV uploading. While less confusing, the workaround I created no longer allows us to “spoof” a proper CSV. You can still use the output from this blog to enter into TurboTax… but unfortunately it’s gotta be manual.&lt;/p&gt;
&lt;h2&gt;Crypto grows up&lt;/h2&gt;
&lt;p&gt;This year in TurboTax, the paywall maze willed into existance by &lt;a href=&quot;https://gimletmedia.com/shows/reply-all/6nhgol&quot;&gt;lobbying&lt;/a&gt;, a question will pop up asking if you’ve sold or received cryptocurrency in 2020. If you decided to get off the crypto rollercoaster this past year, you will wind up being cornered into paying for TurboTax Premier; for “cryptocurrency support”. &lt;/p&gt;
&lt;p&gt;Coinbase, the largest crypto exchange, similary advertises a TurboTax cupon code to allow compaibility on their &lt;a href=&quot;https://www.coinbase.com/reports&quot;&gt;reports&lt;/a&gt; page. All you have to do, says Coinbase, is upload their “CSV” to TurboTax.&lt;/p&gt;
&lt;p&gt;The problem is that the two systems are not actually compatible. What follows is the uncovering of a rather large miscommunication between two large companies.&lt;/p&gt;
&lt;h2&gt;Silent hot potato&lt;/h2&gt;
&lt;p&gt;After happily downloading the &lt;code class=&quot;language-text&quot;&gt;.csv&lt;/code&gt; (Comma Separated Values- Excel sheet with commas instead of lines) from Coinbase in one tab and uploading to TurboTax in another, the TurboTax UI returns an error that the column names are wrong. Coinbase does produce a &lt;code class=&quot;language-text&quot;&gt;.csv&lt;/code&gt;  and TurboTax accepts &lt;code class=&quot;language-text&quot;&gt;.csv&lt;/code&gt;‘s.
However, I found they are actually two different kinds of report. &lt;/p&gt;
&lt;p&gt;Coinbase gives you a simple log of transactions, with the columns: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Timestamp,Transaction Type,Asset,Quantity Transacted,USD Spot Price at Transaction,USD Subtotal,USD Total (inclusive of fees),USD Fees,Notes&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;TurboTax, however, is looking for this &lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;ASSET NAME,RECEIVED DATE,COST BASIS(USD),DATE SOLD,PROCEEDS&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Support responses in the TT &lt;a href=&quot;https://ttlc.intuit.com/community/taxes/discussion/coinbase-csv-file-not-compatible-on-turbotax-no-headers-found-in-this-file-error/00/1820285/page/_18&quot;&gt;forum&lt;/a&gt; vasciate from the mildly confused to the overtly inaccurate.&lt;/p&gt;
&lt;h2&gt;What is actually needed&lt;/h2&gt;
&lt;p&gt;Say I buy one bitcoin for one dollar last week (can you imagine?). This week, I buy another bitcoin at two dollars. Immediately after, the price goes way up and I sell one token for ten dollars, keeping the other one just in case.&lt;/p&gt;
&lt;p&gt;Next year, I’ll have to tell the IRS &lt;em&gt;which token I sold&lt;/em&gt;. If I sold the first one, I made $9 USD in profit, but if I sold the second one, I only reveal $8 USD in profit to the Uncle Sam. The first way is known as FIFO (First In, First Out). The second is LIFO (Last In, First Out) and is more favorable when the price generally rises because less taxable profit is displayed.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 580px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/17d04ec4334606bf7770d1f4aa48112c/b6272/fifo_vs_lifo.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 44.93670886075949%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACK0lEQVQoz62Ry09TURDGv3tPi8ESRTQuFIVGo7EETTRxaVy4UTeuXfgP+E58YIILJb4gRmNAogaF1JiW3JSCtWnppb2UtpfePuyL2jetqQXRFqImbEiOOdi4duGXzOLM+TLzmxkIYgDj0xFMuKN8jVIOANYo5SzeBN87qEdrmxYqlZrlCf5Fo5OzGHdHYLTLoJSylGZhjeKDbw73nw1ht3YPK7QRQBMANTNc7b7HMS+LEbMTz9+acanrDm7e7QMEhx8Gm69pKlw4YPEmdF09j4+bpoIdrmhR92hgeAvAANXbAewEsIEV1O7d9xfo2ImTOHj4KDoOHcF+XSdg8cTZyKc8yQp1RUurgqj8dIRyv7yfFqjB5jsbKNRgVzJk0+ZmqBsaVAAa65O08DzfDoCvxx/ZlTSscvKMkqtSX2qRTszEqDtRpuxt8cbPsX8lXyOUUi67TNmuewP5WtURzBbGXOGinP5aljNLcw/632x7abAAY64QBFFpd0WKlx3B7IVRu3zR5k+dl2Kla0+HjJ2M5rVg5+pU3DvrzGlPsnLbKievm5yhG1KsdEuKlq70PHmh6R8xAWIov04ZLv2AL7UIg80Ld6KM4PwK5PQSmlu2agDsYjvc0drWYJY+IvZlFWI4D7MURnB+GaHiCvoG9awxYPOn1y+q5KrEk6wQQVTIdPwzcUaKpE5FwHHsyo369xKkaIlj3slAhpicITKb/Ub82e/k4cAwXhmt+O/6DWikIdCl2mgKAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;fifo_vs_lifo&quot;
        title=&quot;fifo_vs_lifo&quot;
        src=&quot;/static/17d04ec4334606bf7770d1f4aa48112c/b6272/fifo_vs_lifo.png&quot;
        srcset=&quot;/static/17d04ec4334606bf7770d1f4aa48112c/c26ae/fifo_vs_lifo.png 158w,
/static/17d04ec4334606bf7770d1f4aa48112c/6bdcf/fifo_vs_lifo.png 315w,
/static/17d04ec4334606bf7770d1f4aa48112c/b6272/fifo_vs_lifo.png 580w&quot;
        sizes=&quot;(max-width: 580px) 100vw, 580px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;There are a slew of “aggregators” mentioned in the forums, but the top option seems to cost about $50 per season. Furthermore I worry about the potential for “lock in”. For example if I use one aggregator, the service would have to remember what I used for cost basis last year. Is this easily transferred to another provider?
I’m currently working on some open source &lt;a href=&quot;https://github.com/nickdnickd/taxmycrypto&quot;&gt;code&lt;/a&gt; that will calculate this on the Coinbase file.&lt;/p&gt;
&lt;p&gt;At the heart of it is a Coinbase Transaction class that will calculate cost basis so that we don’t hav eto pay taxes on the whole asset:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CoinbaseTransaction&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Class for keeping track of transactions.&quot;&quot;&quot;&lt;/span&gt;

    timestamp&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; datetime
    transaction_type&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; TransactionType
    asset&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AssetType
    quantity_transacted&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;
    usd_spot_price_at_transaction&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;
    usd_subtotal&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;
    usd_total&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# inclusive of fees&lt;/span&gt;
    usd_fees&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# How many of this asset did we attribute to profit&lt;/span&gt;
    BASIS_COLUMN_NAME &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;quantity_attributed_to_profit&quot;&lt;/span&gt;
    quantity_attributed_to_profit&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;cost_basis_usd&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; quantity_considered&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Cost basis is how much we had to spend to acquire this asset
        Includes the list price of the asset plus any fees.
        Since assets are divisible, we attribute the fraction of the fees
        use to buy this assset.
        &quot;&quot;&quot;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; quantity_considered &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;usd_spot_price_at_transaction
            &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;usd_fees &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quantity_transacted
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Early conclusions&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;This seems to be a case study in the communication breakdowns between large companies as well as between companies and their customers. Coinbase and TurboTax had a different understaning and now many customers of both are confused.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CSV as a file format is fantastic for starting a project, but will quickly break down in the long term since it does not communicate much structure.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;These companies should integrate more tightly. TurboTax should connect directly to Coinbase’s API with limited read permissions, while Coinbase provide this aggregation as a service.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;These customers (including me) are in a captive market with a very low barrier to entry. It takes 5 mintues to set up a coinbase account for free and start buying and selling cryptocurrency but there isn’t much choice to avoid audit exposure without paying the piper.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;This code may eventually manifist into a web service that retains cost basis in a database, but I will leave the core part open source.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It would be more secure and less error prone to connect to Coinbase’s API and allow users to use oauth to only grant transaction history&lt;/li&gt;
&lt;li&gt;The user would still need to specify if receiving an asset on an exchange was actually income or an internal transfer from another wallet outside the exchange.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Disclaimer&lt;/h2&gt;
&lt;p&gt;None of this is tax advice. Please consult with you financial advisor.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;I discovered this by successfully uploading my Robinhood cryptocurrency tax csv and comparing the differences. Just wanted to give a shout out to Robinhood for being on top of this. I used their format as a model for the output of the code.&lt;/p&gt;
&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;
&lt;p&gt;Don’t take my word for it; &lt;a href=&quot;https://ttlc.intuit.com/community/taxes/discussion/coinbase-csv-file-not-compatible-on-turbotax-no-headers-found-in-this-file-error/00/1820285/page/_18&quot;&gt;here&lt;/a&gt; is the latest forum page of enraged TurboTax users.&lt;/p&gt;
&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Asynchronous Uploads]]></title><description><![CDATA[I will never forget the first time I killed the music in a local coffee shop. Struggling to teach myself “machine learning”, I decided to…]]></description><link>https://nickdnickd.com/async-uploads/2020-11-1-Async-Uploads/</link><guid isPermaLink="false">https://nickdnickd.com/async-uploads/2020-11-1-Async-Uploads/</guid><pubDate>Sun, 01 Nov 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;I will never forget the first time I killed the music in a local coffee shop.&lt;/h2&gt;
&lt;p&gt;Struggling to teach myself “machine learning”, I decided to download large dataset from the internet. As is typical with these types of workloads, the download size was well over 100 GB.
When I clicked download, Google Drive split the file into several chunks available to download simultaneously.&lt;/p&gt;
&lt;p&gt;The competing music streaming device yeilded immediately, and acoustic pop covers were replaced with &lt;a href=&quot;https://en.wikipedia.org/wiki/4%E2%80%B233%E2%80%B3&quot;&gt;4’33”&lt;/a&gt; on repeat until I realized what I’d done.&lt;/p&gt;
&lt;p&gt;I think that browsers are actually polite by default. If we begin a single download of a file, the download code doesn’t try to use up all of the bandwidth and will likely only download one part at a time. This is what allows the network to live in harmony, with multiple people able to download what they need at a reasonable speed.
This Drive download acted differently and it felt sort of powerful.&lt;/p&gt;
&lt;h2&gt;Bandwidth&lt;/h2&gt;
&lt;p&gt;The Media &amp;#x26; Entertainment Industry struggles with a similar problem with large files. The original formats of files from the camera will typically exceed hundreds of Gigabytes. To cope with the long transfer times, a proprietary industry standard tool, Aspera, has been the de facto leader. Aspera uses a custom protocol (FASP) to transfer files and uses a browser plugin to implement the protocol.&lt;/p&gt;
&lt;p&gt;Aspera is brilliant &lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. The user can manually alter their upload speed and quickly meet the constraints of their hardware.&lt;/p&gt;
&lt;p&gt;Recently, Aspera added integrations with cloud object storage, such as s3. But I wonder if this misses the point. Object storage &lt;strong&gt;is&lt;/strong&gt; a service in front of storage already. Can we push these existing servers to their limit with coffee shop buckling magic?&lt;/p&gt;
&lt;h2&gt;A sink&lt;/h2&gt;
&lt;p&gt;The general reason we want to transfer large assets to a centralized location is that the source created something valuable. The sensor on the camera shooting Selling Sunset in 4K produces, for now, uniquely valuable information. Reams of sensor data must be shipped back to home base for post prodcution to be around computers that can handle the job.&lt;/p&gt;
&lt;p&gt;Starting out, this is how it can be done.
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 504px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1a593cb03bc811628806e8de05692f88/08115/s3_simple.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfklEQVQoz1WQ309SARTHzxXM6sXmU0+t5lPpmOKakteFP0qjNV1aD66HXHO9+NQf0Gq9uLZ6srXpmoW5zH6YVy4hE3/ce0GBSOFe4AKKIBdFMMNKs4ROu2y5/G7nPHy389n3fAERYYaPDbgiabSJ65sU61bLnnHWR5mdoSWTPeAxcLwww8fczvDXmNkZvOlLZkBMZfPwMMAwqYL5yyTMNWlyAxlEYARp1MDxyHpX8Z3F2SwDKcadfGXk8O2EA83OIM6FUuiJ7+C0J3p3aQtBjKaVdh2ZR9eWAz65B29qVIR8B/KanF/uYwTpG8PHNiyfw5rwdwSzM9hL27xTBo43Wv2JcfviF8NsYJ0z2cVWMY25OzlRqKUmHyWLDMx5EN1GeD4ycWTaEy0cMlkLu3v6Ff5UFhp0LcoBalrZ2t5RAADHAEABAPlKgLzOU8fBVFtxlNKWF+s1JbMuHfn4fumJIrzVpoTYTwT96JScCEaZBZCV69WzQtvEhMT5VgOMIIVtYsI/F0oladZ92zcyBj1kmcalIzOUVo3PKs/g4LlSF37oL4AdRDBYBfltoneIzvUgz7gjEBvjeKRtXhx3BHByfhnd0jaa7eID3EV4VF2m/aSrRkvD2d3XpAr1mpIwctQh+F9VNXXwDzi1EHnKCvFJRpAMrDduZL3xMat/jf3IedqGux9C33l1haNJE7Vea8T3F6uyLypP00jpCw4A65qu7AMX0wjixh8IbiIs/0CIbCMkEWElg9COCGvNWrlTxSCperl0tb4LO69DtO2C4gCw/lLzPlD6hUR8D4nVPSQSWSTWEYktRCLyG4EAAL6xEnrUxXJS2OlohTsniwC7bsBf+7eXaT9lAScAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/1a593cb03bc811628806e8de05692f88/08115/s3_simple.png&quot;
        srcset=&quot;/static/1a593cb03bc811628806e8de05692f88/c26ae/s3_simple.png 158w,
/static/1a593cb03bc811628806e8de05692f88/6bdcf/s3_simple.png 315w,
/static/1a593cb03bc811628806e8de05692f88/08115/s3_simple.png 504w&quot;
        sizes=&quot;(max-width: 504px) 100vw, 504px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;
This is fairly straightforward.&lt;/p&gt;
&lt;h2&gt;And a wait&lt;/h2&gt;
&lt;p&gt;The problem makes itself apparent when the source size exceeds memory capacity. What happens when the file is 15 times larger than your memory capacity? To get around this we leave the rest of the file on disk and only read one chunk at a time and send it.
Scale up the file to 400 GB. Libraries usually reccomend a chunk size. This chunk size is often less than 100 MB. For each request, it comes in phases that will often look like this drawing:&lt;/p&gt;
&lt;p&gt;Standard chunked upload of a file.
&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 583px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b01ecf09c721e5ca7d168ead92c421aa/9fc4b/s3_chunk.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 71.51898734177216%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADsUlEQVQ4y4WUa0xTZxjH/+fAJMwhfpDFZS5mESFIsGsoIDdhikqduiUjE1hiFrcPxmSym1vm3BZ1i1uykCUYlTAZm7rCRKQ3ajml5fTe00NbeoFe1pbQWhHGwDnjnMne5Zy4fVt4kv+35/m9z+WfF3gcGlsQ5mAaN0weqK2BFjaQOs76Z48xfOzYmDdxXM9F9id+JyCEoOuH62JNy7N5KFsNqBqluNe2VxS++1kHgydOD7NeOv2Q0ELBIOOKDOgdRGWeJCOOKWIJpol1KmMHQC0QQj0kBLbdFeivK4OzuYYe3i7BxYpi2tBUQaFboYFhIg49F8E7J86IL2ttwfMq86RXaw9ZXbFfrXxiyWcOpr8CQB957wQt5HRXlmCgrgwueQ3CB2qpc7IiGJsqgQtXlblGb7KW4WPbflQanwSQ3dmjWKu2+Nd98PnXGzo+Pr3+o9PfFLx78ss8AKueWpNPicCqUnj21uYO1kv2KBukHLu76vVLVSVrMGjgSh3R+UfO2AIZdcfeEEYe8yaU5mB62RxMp62hTMqd+O2uPTzXK3S479W2rE+rJFnjTeXoqy6VOZqr/75eJyG9VSXEuKuyDSP2kIThY8TomxH29ck8IbjpCnu09hDRc1FimIgTLr5IbNNzowByNhWV5FauL8glyi/QJSuud8lrCLtv+6O+6lJi2Ck7jO+HmAJ7+M5JR+TOGZ1zWjrmSWDUHa3j4osvK1nfjlF3tHHcP/uK1h6SCet46+0PxUt3SjdD2ygtYJoqThn2N9xV75SdG67fWoi+IQZcfFHUqDsqKIvhf4EvdV/o9LDWFmyZTN9Hz8AIiku3rhIu/VrhczhV9jx1QbYZ99pfQn954RbQgLu5GriiHocllMm2Td/O1lgDdL/Ohp+0lnyGj10a8yYJn1wmbCD17fufnRWOktf+5lHxKPoXX8B5WRG12CrP6i8vxKb8LMq5Zxv9r69xtqtXHEWQOZi+Zg/Pkb4h5sGYN/GX/9YDojL7rgB4mhBCKVkf1uU8gYMb8rGrIAeqBim13CrHUqv8Px66FWoEMn+KQD0X2cjwMZXa4ie28Byxh+cUQ0b+mR3NBwSbiTkrxk1XBENGHtcYF6xTt5H8g8Dkm+lQ6GwdAsDkm8FjS8HoTa4MHB73Cp4UgGsNnvghS+jWocsq08HOHsVRjS1whPXPtl9UqFdfVo1DobOuDNRzEVprDwmfxBZHZH7GnVjKKFlfRuecTvHJ5YwzuhC7qjFvFCa4YZqg/g/0D3QkAitOQOHlAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/b01ecf09c721e5ca7d168ead92c421aa/9fc4b/s3_chunk.png&quot;
        srcset=&quot;/static/b01ecf09c721e5ca7d168ead92c421aa/c26ae/s3_chunk.png 158w,
/static/b01ecf09c721e5ca7d168ead92c421aa/6bdcf/s3_chunk.png 315w,
/static/b01ecf09c721e5ca7d168ead92c421aa/9fc4b/s3_chunk.png 583w&quot;
        sizes=&quot;(max-width: 583px) 100vw, 583px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;When dealing with this type of web request, the typical loop looks like this in a straightforward loop.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/93d8656cd01125fb68a90be8e216a08c/cc155/s3_time.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 15.822784810126581%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVQI12PYd3anzrGrB3Lvnd+V8uzCrrQn53elPb2wK+3TnSNpn+4cBeOPt4+knby4N+30pb1pj8/uSHt2cXfawzPb015d2QeX/3TnaMarq/siGbYe2Ziy78yOn7dOb7v/4NTWx/dObX18//TWx5/uHH38+e6xx59B9J2jj4+f3/3o5MU9j+6f2vro8bkdj24f3/zo5ZV9j749OPHoy91jD7/eP/7s7Y2DRxlsnazZTK1MBPtbythm9dSyz+6tY5/RVcPuYGXCbmdhxG5lasBuZ27I9v//f6b///8zQ2kofsbUVpXLtHBSM9PcvgamGV01TAAESp3uDOobkwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/93d8656cd01125fb68a90be8e216a08c/f058b/s3_time.png&quot;
        srcset=&quot;/static/93d8656cd01125fb68a90be8e216a08c/c26ae/s3_time.png 158w,
/static/93d8656cd01125fb68a90be8e216a08c/6bdcf/s3_time.png 315w,
/static/93d8656cd01125fb68a90be8e216a08c/f058b/s3_time.png 630w,
/static/93d8656cd01125fb68a90be8e216a08c/cc155/s3_time.png 886w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;You can see that stacking multiple requests can add up over time. Come to think of it, is there really a strict dependency on the last web request finishing from s3? If the target can handle it, we shouldn’t care either. Let’s get something going like this:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/319a29518c8545c702d90762dcf7240c/ef3e1/s3_async.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACuElEQVQoz22SzU/TcBjHH148SOLJxGR6FmY8eeEvMDHevOlRj5496EGPSIx4EAWVNw8w5GUKC7CuXftruxVYO1i7toyxsbEVtnXjHYUN9/Iz7UFD4pM8eW6f5/t8vw9gjMFqmhiD5OIsqJwbEkse0Dg3cDNDwM8M2x2YHYEw6QL3cA/cud0BEf83+G+97HrR9ujxww7XaO813/SAY2G8z0FPf3EQ432O0Y9dDlf/a8fkwBvH+Kfu6/6pz1fx+VZLQaWb8WEMcEmFfNR/EegPLTxlFRrHVXrPCM3lcwpVTEsLpR2ZLJ4bUrGcEYun6eXC2Vbo5GAjgPC+DqU1BEeJYEtKnGsq6ghKOvoHZMJEJ6+h55EovaLrLN7RETYVCpd0hPdiHD5KBHElK+FKVsS/0kv7x0mhv6SjJwfxgG1LLuqHgkrDjkzCdoQE0LNhENY4ICXvM6QhY0Nl9rOKv17QmJoR8dVLOqpXDKlezoTq5YzYsOBHiaCUCXtvGhHfDUvUcVJowqYC2JQBxPVAk5qXW9Ci5/KyGQV2xccLGsK5Nfa3qVDVgko3tsJevL/O43o+YgGr5YxYKWdFvBtjuxv5CJga03S4EWy1FMNX9yC4qQk7aVJcAF6hO4nluQfhKL2nxjhsakzdVKiGqTGNnEI1TpJC49xWbFuQ/plaQjsyeXdvnbM/ASYJF0wRLng/2AMe7kczkikoNHLAyP7eoMoEkjqqbGmMBcY5hcKHG0F8ml7GZ5mQfb6l9CDOj+zG2Hspcd7xNxwxHgRBZ2FxjWsWdLYVxXjoefvqCiP7zZUYj7cjZDWvUDVj1VdLi/O1k02hfm5I1XJWrFQMyVqAt2Xy/oUX+k5N2PPD0DvbAiY0f0nQ0M2g5L2VXSGcxirhzCmUs6DSzkzY69wMzTlT4rw12xNLnnaRGGv7AzRxAmQy3himAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/319a29518c8545c702d90762dcf7240c/f058b/s3_async.png&quot;
        srcset=&quot;/static/319a29518c8545c702d90762dcf7240c/c26ae/s3_async.png 158w,
/static/319a29518c8545c702d90762dcf7240c/6bdcf/s3_async.png 315w,
/static/319a29518c8545c702d90762dcf7240c/f058b/s3_async.png 630w,
/static/319a29518c8545c702d90762dcf7240c/ef3e1/s3_async.png 759w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Quite literally, 7 requests can happen in the time of two requests. The tradeoff is that we are a bit rude on the network and hog our own networking card for resources. If no constraints are in place we could very well use up all of the bandwidth.&lt;/p&gt;
&lt;p&gt;The power is in the ability to wait for multiple chunks to complete at the same time.&lt;/p&gt;
&lt;h2&gt;Not Magic&lt;/h2&gt;
&lt;p&gt;Can we just keep lobbing chunks at the network until it is saturated? Well not quite. Yet again we run into memory constraints. Each of those chunks may require a retry, and in order to do so I hold on to the buffer in memory.&lt;/p&gt;
&lt;p&gt;This introduces a slew of other problems. To demonstrate the complexity we take on, I will put off the buffering mechanism to another post.&lt;/p&gt;
&lt;p&gt;To get a look at the code you can find it &lt;a href=&quot;https://github.com/nickdnickd/botnica&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;That’s not say Aspera didn’t have its own quirks in the field. In atypical network environments for documentary filmmakers, we saw issues particularly within univerisity networks. And it is pretty expensive. On top of the current infrastructure, it costs about $1 USD per GB transferred in their SaaS offering. Under enough load these Faspex servers would also go down.&lt;/p&gt;
&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Avoiding Manual Data Entry]]></title><description><![CDATA[Interview Season Doctors have it rough. After graduating medical school, they enter a period of indentured servitude known as residency. It…]]></description><link>https://nickdnickd.com/web-scraping/2020-09-12-Avoiding-Manual-Data/</link><guid isPermaLink="false">https://nickdnickd.com/web-scraping/2020-09-12-Avoiding-Manual-Data/</guid><pubDate>Sat, 12 Sep 2020 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Interview Season&lt;/h2&gt;
&lt;p&gt;Doctors have it rough. After graduating medical school, they enter a period of indentured servitude known as &lt;em&gt;residency&lt;/em&gt;. It is not uncommon to hear of over 80 hour weeks, 12 hour shifts and DOMA’s. DOMA stands for “Day Off, My Ass” which describes the period of time between a night shift, letting out at 7am, and a day shift starting at 7am. Technically 24 hours, but most of it is spent asleep. In between these brutal shifts, a resident very near and dear to my heart has begun interviewing for a fellowship. A fellowship is a brief extension to residency that allows a doctor to focus on a specific area within their field of medicine. One example is ultrasound. This is a rapidly developing subspecialty of emergency medicine because it provides a quick, noninvasive view of a patient’s internal state. &lt;/p&gt;
&lt;p&gt;Throughout the country there are over 100 ultrasound fellowship programs, all vying for candidates on &lt;a href=&quot;https://eusfellowships.com/&quot;&gt;this website&lt;/a&gt;. I have visited this site over 100 times to help my SO compare and contrast.
It’s not the most beautiful website, but it gets the job done. One can tell that the data are organize in some sort of database behind the scenes and uses PHP (something I know nothing about). However, the site’s frontend takes the form of a tree-like structure with different characteristics nested in links on the side pane.&lt;/p&gt;
&lt;h2&gt;The boring way&lt;/h2&gt;
&lt;p&gt;Say I want to compare the salaries of 20 different programs. To view all of the programs, you have to go to &lt;a href=&quot;https://eusfellowships.com/program-list-new/&quot;&gt;/program-list-new&lt;/a&gt;. Once there you must click on a program, then click &lt;strong&gt;Read More&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/84164261b6dac6fdb9b1b6f2c67f9239/0e758/program-list.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 61.39240506329114%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB20lEQVQoz42RzW7UMBSF8/4PwYJlQRW0IxYFNki8AQhKi4AZ5jd2nMQ/iZ2JP7CT6bQSCyJ9OtdX8fG5dvHu5i3vb254vXjDsxfXvLq85OXFBYurq8z1zOI/KTwQgbWHD9sjyo/UfuQ490+k9QgYoBxAHkEMsO2nOmmi2BvPwQbWleZ+teVuved+c+B2tePLcsvX5aRLqfN/O+0f2CfMpFvd517B/I3jSKsNxliaVqO1xjuDt5reauLgp4zxlHWux+Pci1mLMUY4Djhj+X7Q/JKWu4Nh13RI7VhKy1o5flc2s1GWpTT8LDWt88Q44vzA55VgtZcU6X4YArHvkK3l0FiU6fDDwF4ZPq0U37Y1snUZpbusonU4H3LSTWV4/vEHtxtFEWO2zBefTrJ9wPSBLgwYY2iUQlUVVSWzZlRFnamRea2wuiH4fjaMkaTp1LK1mVTXTcOhLBFSIoQ8q5CUQiJl9bBOtXPuUcIYaTtP43pq2+WE6WFOG4QQmZQok8ykpCynfqXUPwyzWZ9N09hN285G54RyTpmNHiW3xuD7/qlhHtN20z12Po9cCnE2ktNocl6nOk2hjclhvA9PDVOqZOZDYGgbGlXnhxrC1AtJvc8bQziTel040v9N+AcOS4wdNl7LyAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/84164261b6dac6fdb9b1b6f2c67f9239/f058b/program-list.png&quot;
        srcset=&quot;/static/84164261b6dac6fdb9b1b6f2c67f9239/c26ae/program-list.png 158w,
/static/84164261b6dac6fdb9b1b6f2c67f9239/6bdcf/program-list.png 315w,
/static/84164261b6dac6fdb9b1b6f2c67f9239/f058b/program-list.png 630w,
/static/84164261b6dac6fdb9b1b6f2c67f9239/40601/program-list.png 945w,
/static/84164261b6dac6fdb9b1b6f2c67f9239/78612/program-list.png 1260w,
/static/84164261b6dac6fdb9b1b6f2c67f9239/0e758/program-list.png 2502w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We are then met with the program page. Once there, on the left pane, under Fellowship Program header, click the Fellowship Program link.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/48bdce51b7312bbb5087d6fcc09812fc/ddb69/program-salary.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 59.49367088607595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACC0lEQVQoz3WS30/TUBTH+/f6J/gDBgwkPPioMfHFkCiJJrzpi/hEoksAh8w4sFsLg7Xdevt7XXu79mNu3XBKOMkn55z2nm96vrfa9vYOj5s7NNabPFlpsNHcYmvzKc2NTVZXG7esNRRrd1hfrtfW0STw3asoigIouS9mQAaoU1NAznNc/Xmu6kkF2oVIed3xeHXm8eJUsP8r4NpPMEXM5RzDjbhwwpquHdC1FD76OKEnUgwvpT9HS+WM/W993pxcsnt0yaHh4vkh+pWFfmVzbg65sRwC4RIHPoHn4osxYuxQZNM7m2hBELHb0tlrX/P8q8mHizFBlNC/GeH4MWFWkt/vBGVVUS2hJcmE960ue60u79pXfOmPEI5FHIXIPKMsJFLmSCnrgbIsb1mIqFhkbTaJ6XXamN0fJK5N7tqEnocfBEwmE+I4JgzDur4vFmK1YF4UHJ39pHXa4Uw3sbwQx3EwDAPXdUmSpBZdZCUeRVFNEATzv4O/K/up5NmhwcqBzsNPPd52RkS+wDBNRqNRPTCbzWqW11UsxP65FHciWf2s8+igx4OPOi9PHGJfYNk2WZaRpinT6fQW1SvUOyWovF1Gy6Tk+NygrQ847l3Td3xGjkPfMLAsi+FwWFtg23adVa8QQtQ2LNZXVqheQ92czCllBkUOVYkrBIPBoPZMoQaW/VO18k995f8r/waDkHUW2eMF3QAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/48bdce51b7312bbb5087d6fcc09812fc/f058b/program-salary.png&quot;
        srcset=&quot;/static/48bdce51b7312bbb5087d6fcc09812fc/c26ae/program-salary.png 158w,
/static/48bdce51b7312bbb5087d6fcc09812fc/6bdcf/program-salary.png 315w,
/static/48bdce51b7312bbb5087d6fcc09812fc/f058b/program-salary.png 630w,
/static/48bdce51b7312bbb5087d6fcc09812fc/40601/program-salary.png 945w,
/static/48bdce51b7312bbb5087d6fcc09812fc/78612/program-salary.png 1260w,
/static/48bdce51b7312bbb5087d6fcc09812fc/ddb69/program-salary.png 2684w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here we have the salary- now enter this in a spreadsheet and do the other 20. You know what? Add Location, Year Founded (age matters here), Salary, Hours, Benefits, Number of Sites, Do they Bill for Ultrasounds? Are the Moonlight opportunites?, etc. Under the &lt;strong&gt;Fellowship Program&lt;/strong&gt; header on the left, both the Program Description and Fellowship Program links for each program contain all of this information, so I’ll see you in a few hours.&lt;/p&gt;
&lt;h2&gt;No thank you&lt;/h2&gt;
&lt;p&gt;Wait a second… check out the url bar. &lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4e738fe7ccbc38975be5986700025839/f1901/url-bar.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 7.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAX0lEQVQI112NUQ6AIAxDPZAiY6iJgCAa73+jmu7DDz+avibdOtTakUvDnoq5xg0pV3iJcHMwTU6+PHvFOPmP6V7UmL2hXw/OfqO2C+Q9HcZBV3suYbEjZvJfHKKzS34Ba5NA2MjrTVYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;program page url&quot;
        title=&quot;program page url&quot;
        src=&quot;/static/4e738fe7ccbc38975be5986700025839/f058b/url-bar.png&quot;
        srcset=&quot;/static/4e738fe7ccbc38975be5986700025839/c26ae/url-bar.png 158w,
/static/4e738fe7ccbc38975be5986700025839/6bdcf/url-bar.png 315w,
/static/4e738fe7ccbc38975be5986700025839/f058b/url-bar.png 630w,
/static/4e738fe7ccbc38975be5986700025839/f1901/url-bar.png 942w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The portion after the question mark is known as a &lt;em&gt;query parameter&lt;/em&gt;. This &lt;code class=&quot;language-text&quot;&gt;program=83&lt;/code&gt; is a hint to me that our browsers are querying the website for different programs by id. Also the fact that the id for this program is a simple integer, as opposed some random &lt;a href=&quot;https://en.wikipedia.org/wiki/Universally_unique_identifier&quot;&gt;uuid&lt;/a&gt; like &lt;code class=&quot;language-text&quot;&gt;10d15da5-6cea-4bd8-814d-e9653b29a7d3&lt;/code&gt;, suggests that programs have monitonically increasing id’s (1, 2, 3, etc). Clicking around other sites has confirmed this.&lt;/p&gt;
&lt;p&gt;Can I stubbornly avoid clicking through these links and run something that will crawl through all program pages? Can I spend 4 hours learning something new that might have just taken 2 hours to do?&lt;/p&gt;
&lt;h2&gt;Forget Gritty, are you Scrapy?&lt;/h2&gt;
&lt;p&gt;When thinking about web crawlers, I originially thought they’d just be a light python library that I would just include and run on a base url.
What I was met with was an entire platform for running distributed web crawlers called &lt;a href=&quot;https://docs.scrapy.org/en/latest/intro/overview.html&quot;&gt;scrapy&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Following along with the &lt;a href=&quot;https://docs.scrapy.org/en/latest/intro/tutorial.html&quot;&gt;tutorial&lt;/a&gt;, we make our tweaks along the way.&lt;/p&gt;
&lt;h3&gt;Step 0, create a virtual python environment and install scrapy&lt;/h3&gt;
&lt;p&gt;We do this to keep the global python environment clean. Dependencies can get tangled up with version numbers. Check &lt;a href=&quot;https://realpython.com/python-virtual-environments-a-primer/&quot;&gt;this&lt;/a&gt; out for a fantastic primer.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;python3 -m venv venv_scrapy&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;source venv_scrapy/bin/activate&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pip install Scrapy&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;Step 1, create a project&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;scrapy startproject usfellowships&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;Step 2, check out the structure&lt;/h3&gt;
&lt;p&gt;A directory layout and boiler play file appear as follows:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 336px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/605f6270deeace5c7c047fd234f60c0e/d99f2/scrapy-layout.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 209.49367088607596%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAYAAACz+XvQAAAACXBIWXMAABYlAAAWJQFJUiTwAAAGHElEQVRIx4VX63MaVRTni99sap8mJTx32V122eVNeJVHoIQQIIG8CIEkJGlsQ53Rqa3TdrTWD1W/WNtRqzPqqDP+nT/nHLoUAmk/nNx793LvPb/z+p1YRNEDj0eCqmpQFC80zccSCoWRyWQRjydgGH4EAkHEYguIRmM893pVmGdHxWJ+NH+4ubnFsrJSxenpKXZ22jg6OsLh4SHa7V30eofo9+8hm83B6XRNXkh/6FJBEOFyuXluisPhZKHvNpudxe0WWOx2B58xz09cKEkywyR4+fwiMpkMisVb6HS6WF1dQ61WY1lba2BtbY3HcDjCl09oaF6q6wbbslRawtLSEsOq1eooFouoVmtYXq4gl8ujWq2i2WyyAhMXmvBoQZvkGLKNKfPzdoZntdp4n+DT+p2QR7VcWIgPNW00mjg6Osb2dgvHx7exv3+A4+NjLC2VIcsKm+mspy2jL4xuki0jkSjDogdoTUJzsh1FxNSwGdWOXjS1SySSSCZTyOfzSKfTvCZzEGSCPgp3KmTzI73u8+nY29tDq9XiONzd7WB9fYNjlS4iuGcRnQvZtIsZmxR7N25Y2Tnz87ahU2gc1dC8w3L2BVXzsWMotWhN4bOxscmZQxm0tbXFGZNKpYewp9rQQ69wTqtQZZntRbl761aJvUrxVy4vc35ns1mk0zcRDIYmvUyXDGQAVfOHICXyEEQJbsEDr1eDrvshSQpm56zwSDIEMgcrIOPt+YFYZMGFgbghOW0wYnEE7jyGV1UR1jWsr9ax325htVKGJnuwu7WBk94+NMnD5xTRDUVw80hry8fBRbyVAuyRIq758zy3JVYwFynhipHH9XAJ8/EK5mLLLBe1DMuMehOX9CxmtAyuGjlYLOVHYFl+BMvSl/iw+QQf9V/jg9Wv4Tj4Adfbz+G98xOKT/6CfvoS8smPUD55gfBnvyLw6c/Q7r7EXOd7yCcvMLPxLSyWpYcYSukBLtQf4uKdV/iw+RTFx38g/vkvCN17heo3fyP9xW+oP/sXpSd/InX/NerP/mHJPPgdm8//g637HSxWIwUWPQmrkYY9lMOsEsOslsAVZQFzegqzvgRmxDAuy1FcEEK4JEdxWY7hqneB59fUOK5rccz5ErBI5Ax2iAOK7oe//xSKT4cmiVitVtBtt7BSLkF0OtCorWB/dwc+RWYnKqLAIrNDBmIZd7sMTyACSVERCkUQjkRh+AOIxhYQCkeQTKWRXyxw6IiiNBEy4ngui/B4NcjZMryaj/OWqovfH+CsoUCnokE1clp1miwObgGSEYJ2+zH8sQT2ul2ugd1ulwsDpdvJyQkzopnzdM4cx3J5+KIgQLTbILjdsL8hKCoOplajxEXfqEDQfLSUndEwCF/vPrRAGLVqjSv29vY2l7B6vc68QkKkRfltcg5pbV460JCLgwiPokEqbUA1gshlc0xWlcoKkxONdLhSqXCRKJfLvN9srrOdTbJ6o6GHvSbLInSvDZIkwGZzwOl08g9N6CSjkM29KZA9cLkkhCMi6msOJFMa2u09dgjxLzmECKrRaAwdYTrjbMUf01CSRKieecjygKOJCggOhQ/ZiUo/aWVqN43g3jqF1FYNKLUOJK8P6VSaqzI1S4uLBZ6nUikEg0Emr/ezniBA8vmhtvsIxBLodjo4PDxCq7XDFEDc3O3usXfpOz1i8sr5JMVxaOeRYJETiJgGJGWD1TrPl4wS2bmdg+h2Q/KH4bv7FfRwDMVCgTPEzBLSjOKyUCiMkdPUzmG4ISuQk4tQNB/bjrowsh0RFBE9BTWR06hD3nOhF3I0yWvyKBUFMj7NSeg3VCTO614niwNBPn0KPbKAvU4Hx7dP0Ov1mIv7/T7DJydRJzGNk8daYhrdLjcEj8wOMTUyu1pqmuibYRgcm++ETK9RDcyt1KH7A0zmZDtqlMiO1EmQDal7oIAf7a3Pv1D1IbtchREModlociHY2trmhp2gUjE4OOhxQaD8ndYbjkHmDtblHsYfNUTmaDZNtEfzsw3SVA2pjyH+oGJARqfGiMKFMoTij5r3g4MDroXneXgsUygczP9X4vE4d69kO7IlOYRGSjfaf9eF/wMguzDqWNoZqAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;scrapy project layout&quot;
        title=&quot;scrapy project layout&quot;
        src=&quot;/static/605f6270deeace5c7c047fd234f60c0e/d99f2/scrapy-layout.png&quot;
        srcset=&quot;/static/605f6270deeace5c7c047fd234f60c0e/c26ae/scrapy-layout.png 158w,
/static/605f6270deeace5c7c047fd234f60c0e/6bdcf/scrapy-layout.png 315w,
/static/605f6270deeace5c7c047fd234f60c0e/d99f2/scrapy-layout.png 336w&quot;
        sizes=&quot;(max-width: 336px) 100vw, 336px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I’ve highlighted &lt;code class=&quot;language-text&quot;&gt;spiders/us_fellowships.py&lt;/code&gt; because this “spider” is where most of our code goes.&lt;/p&gt;
&lt;p&gt;Let’s dive into the structure and code&lt;/p&gt;
&lt;h2&gt;Step 4, our spider&lt;/h2&gt;
&lt;h3&gt;Spider file setup&lt;/h3&gt;
&lt;p&gt;These are the global constants and libraries pull in to set up the spider.
It was here where I declare the start and end to the program id’s. No id goes above 150 and when we find an empty page, skip over that.
&lt;code class=&quot;language-text&quot;&gt;position_headers&lt;/code&gt; is a dictionary for us to translate the headers inside the webpage into more consise data columns. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; scrapy
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; urllib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parse &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; urlparse

START_RANGE &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
END_RANGE &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;150&lt;/span&gt;

position_headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Salary&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;salary&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Number of Clinical Hours&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hours&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Number of Sites&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;sites&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Year Fellowship Started&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;founded&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Do you bill for ultrasounds?&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bill&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Do you require follow up imaging for patients who get ultrasounds?&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;follow_up&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Spider class and attribute definition&lt;/h3&gt;
&lt;p&gt;Our Spiders are a child class of base class &lt;code class=&quot;language-text&quot;&gt;python scrapy.Spider&lt;/code&gt;. The key attribute here is &lt;code class=&quot;language-text&quot;&gt;start_urls&lt;/code&gt;. I use this list to declare all of the program descriptions I will walk through, including the overall list which gives us location and id to name mapping.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UltrasoundSpider&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scrapy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Spider&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us_fellowships&quot;&lt;/span&gt;
    allowed_domains &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;eusfellowships.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    start_urls &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;https://eusfellowships.com/program-fellowship-position/?program=&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;program_number&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; program_number &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;START_RANGE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; END_RANGE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;https://eusfellowships.com/program-description/?program=&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;program_number&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; program_number &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;START_RANGE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; END_RANGE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;https://eusfellowships.com/program-list-new/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;The Parse function&lt;/h3&gt;
&lt;p&gt;There are three types of url in our scenario: program list, program description, and fellowship position. For ease of use, each type of webpage has an id as well as the kind of information on that page. For example, the program list contains all of the program titles and locations.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

        current_url &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; urlparse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Parse program list for information&lt;/h4&gt;
&lt;p&gt;The program list convienently contains all of the program id’s, titles and locations with currently active ultrasound programs. The key question to me was “what is the actual container of information on this site?“. Looking closer at the structure, we have to dig into the html elements of the website using Developer Tools.&lt;/p&gt;
&lt;p&gt;The spot that contains the location, program id and title for each program is the detail panel that appears when one clicks on a particular program.
With Developer tools open, click one of the links and hover around the header. You would see somethoing like the following:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8dc6aa3a7340d63612716a5e7f659e13/7f486/program-detail.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50.632911392405056%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACV0lEQVQoz2WPa0+SARiG+Q+lHdZKTQ4CL7wnQBDMZeZvsD+SbqFbW/mtrZIBL+Zhs2kf+gGOEFt+yHJLrVhCBq/gKdRktHnKXU2wtvLZrt17PjzX7scwNvac/oEhYrFnDGoaw0NDDGoxtGiUWFQjpmlEIxFGhkfo6rpD3bV6JEFAESVkp3iaTlyyjM/bgmEfmC/B9hGUjuEAODrlkOpepjr3H/Zja7LQ6ffgU5yIgh2HYEOwWnDYmrCajRh2dvdYK5RZyZfZLR3wY7fE5vctNjaLlMo/Ofx1zN7+YUV4t7uHy/VG2vwtdLoEmkUBlyTisAtcbzTR0NCAYX1rg+mFReYyaeazaRb0JRZyS8xnv5AqLJPeyPExn2Fnf5u+4D2uXK3jRqufDr+TVr9CIODB7VMQFQd2mxXDcjHLo3iKpwmd0FSW0FSOUDLHwFSO6GudwTc6wZcpXqW/0v+gj0ajGX9HO97bMr5bIr6bClK7iNTqxKWqGLLFFcKJDFpylVgyX2X6D4VKPpnUeZ9foy/YzbnztUgeP35VoU0R8Trt2E0WbBYrJrMFw7eiTjixhJbME53Sz6AldUJxnbnV1YqwpvYSkqIgCjZkp4AoOrHZ7VgsFowm07/Ck+Oz5AjFcxVhb0V4EbfHg0sW8agyqqrQZLViNpsr0oowFM8QSawRTuQJJwpE/uPx5Er15d5uamou4GtpQXW5kE+aShKyLCNJEqaThtliltGZOSZmU4y//cT47Gcm3qUqvDhldGaRD+tZeoM91NZeJBAI4PV6aW5uxu12o6rq3/wNaPYI7Rg8hvAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;program detail&quot;
        title=&quot;program detail&quot;
        src=&quot;/static/8dc6aa3a7340d63612716a5e7f659e13/f058b/program-detail.png&quot;
        srcset=&quot;/static/8dc6aa3a7340d63612716a5e7f659e13/c26ae/program-detail.png 158w,
/static/8dc6aa3a7340d63612716a5e7f659e13/6bdcf/program-detail.png 315w,
/static/8dc6aa3a7340d63612716a5e7f659e13/f058b/program-detail.png 630w,
/static/8dc6aa3a7340d63612716a5e7f659e13/40601/program-detail.png 945w,
/static/8dc6aa3a7340d63612716a5e7f659e13/78612/program-detail.png 1260w,
/static/8dc6aa3a7340d63612716a5e7f659e13/7f486/program-detail.png 3010w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Here we can see that the container of this information is &lt;code class=&quot;language-text&quot;&gt;fellowshipPrograms__content&lt;/code&gt; inside an html &lt;code class=&quot;language-text&quot;&gt;&amp;lt;div&amp;gt;&lt;/code&gt;. This class name is queried in scrapy with the &lt;code class=&quot;language-text&quot;&gt;response.css()&lt;/code&gt; method, which collects all of the elements matching the search term. The search term syntax is &lt;code class=&quot;language-text&quot;&gt;html_element.css_classname&lt;/code&gt;. Putting that together, our container of valuable information can be found with &lt;code class=&quot;language-text&quot;&gt;programs_content = response.css(&amp;quot;div.fellowshipPrograms__content&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Once we have the content panel, we must query the children of the element for the actual text we need. Inside content, there is title. This is the program title that we want in our output. To get this string simply add &lt;code class=&quot;language-text&quot;&gt;::text&lt;/code&gt; to the query term of the html tag and call the &lt;code class=&quot;language-text&quot;&gt;.get()&lt;/code&gt; metho on the result. This content happens to be part of a paragraph element, &lt;code class=&quot;language-text&quot;&gt;&amp;lt;p&amp;gt;&lt;/code&gt;. The final query looks like &lt;code class=&quot;language-text&quot;&gt;title = prog.css(&amp;quot;p.fellowshipPrograms__content__title::text&amp;quot;).get()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Finally, &lt;code class=&quot;language-text&quot;&gt;data_row&lt;/code&gt; is the dictionary that holds information for each webpage we visit. It will return the data in the result &lt;code class=&quot;language-text&quot;&gt;out.json&lt;/code&gt; file.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;        &lt;span class=&quot;token comment&quot;&gt;# Get all programs list data&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;url &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;https://eusfellowships.com/program-list-new/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            programs_content &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;div.fellowshipPrograms__content&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; prog &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; programs_content&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                data_row &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;p.fellowshipPrograms__content__title::text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                location &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&quot;span.fellowshipPrograms__content__location::text&quot;&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                program_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;a.fellowshipPrograms__button&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attrib&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
                data_row&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;program_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_id&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;program=&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
                data_row&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; title
                data_row&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;location&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; location
                &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; data_row

            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Parse the description pages&lt;/h4&gt;
&lt;p&gt;And that’s the essence of css-based web scraping. Apply this approach to the two other types of web pages and data_row will soon contain all of the useful information from the website.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;        &lt;span class=&quot;token comment&quot;&gt;# Step 0 - get program id&lt;/span&gt;
        program_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; current_url&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;query&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;=&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;program_id: &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; program_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# Step 1 - Get the title of the program&lt;/span&gt;
        program_main &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;div.programExtra__main&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        
        program_title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_main&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;h2.programExtra__main__title::text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Title: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;program_title&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        program_content &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_main&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;div.programsExtra__main__content&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; program_title&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# print(f&quot;Program Content: {program_content.get()}&quot;)&lt;/span&gt;
            program_headings &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_content&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;h4.programsExtra__heading::text&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;getall&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            program_textareas_raw &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_content&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;p.programsExtra__textarea&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;getall&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

            program_textareas &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;program_textareas_raw&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                program_textareas_raw &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_content&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;css&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    &lt;span class=&quot;token string&quot;&gt;&quot;div.programsExtra__textarea&quot;&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;getall&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; raw_textarea &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; program_textareas_raw&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

                    program_textareas&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                        raw_textarea&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                            &lt;span class=&quot;token string&quot;&gt;&apos;&amp;lt;div class=&quot;programsExtra__textarea&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;
                        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;/div&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                program_textareas &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                    raw_textarea&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                        &lt;span class=&quot;token string&quot;&gt;&apos;&amp;lt;p class=&quot;programsExtra__textarea&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;/p&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;br&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&amp;amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; raw_textarea &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; program_textareas_raw
                &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

            data_row &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            data_row&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;program_id&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; program_id
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; heading&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; textarea &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;program_headings&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; program_textareas&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                heading_clean &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; heading&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strip&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                text_clean &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; textarea&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strip&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\t\n &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; heading &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; position_headers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;heading_clean&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                    data_row&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;heading&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; text_clean

            &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; data_row&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Runner&lt;/h2&gt;
&lt;p&gt;This combines all of the information together in &lt;code class=&quot;language-text&quot;&gt;runner.py&lt;/code&gt; (see directory structure above).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; os
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; scrapy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cmdline &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; execute

os&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;chdir&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;os&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dirname&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;os&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;realpath&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;__file__&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;scrapy&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;crawl&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;us_fellowships&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;-o&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;out.json&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; SystemExit&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Just run &lt;code class=&quot;language-text&quot;&gt;python runner.py&lt;/code&gt; and watch the machine churn.&lt;/p&gt;
&lt;h2&gt;Results&lt;/h2&gt;
&lt;p&gt;Here is an except from &lt;code class=&quot;language-text&quot;&gt;out.json&lt;/code&gt; for id 53. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;&quot;program_id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;53&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;salary&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;$115,000&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;hours&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;660&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;sites&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;&quot;program_id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;53&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;founded&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2006&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;bill&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;yes&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;follow_up&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;no&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;&quot;program_id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;53&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Temple University&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;location&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Philadelphia PA&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Each type of web page yeiled different information.
In the end, it was easiest to parse process this file into a csv that contained a single row.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Program, Location, Founded, Salary, Hours, Benefits, Sites, Bill/FU Study?, Moonlight?
Temple University,Philadelphia PA,2006,&amp;quot;$115,000&amp;quot;,660,,2,yes/no,,,&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Let There Be Sound]]></title><description><![CDATA[Beautiful Soup Does it bother anyone else to think about how we can’t completely describe complicated things? Most of us have heard of the…]]></description><link>https://nickdnickd.com/fft-basics/2018-01-16-Let-There-Be-Sound/</link><guid isPermaLink="false">https://nickdnickd.com/fft-basics/2018-01-16-Let-There-Be-Sound/</guid><pubDate>Tue, 16 Jan 2018 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Beautiful Soup&lt;/h2&gt;
&lt;p&gt;Does it bother anyone else to think about how we can’t completely describe complicated things? Most of us have heard of the &lt;a href=&quot;https://en.wikipedia.org/wiki/Uncertainty_principle&quot;&gt;Uncertainty principle&lt;/a&gt; describing that a more accurate measurement of position of a particle sacrifies the momentum accuracy. Here breadth, by principle, is sacrificed for depth. On a larger scale, we probably do not have enough compute on planet earth to describe a cold front, let alone weather, in a way that yeilds complete confidence in weather reports. Instead, we’d like to know generally if it will rain. This is us sacrificing depth, by lack of resources, for beadth.&lt;/p&gt;
&lt;h2&gt;It’s All Good… Enough&lt;/h2&gt;
&lt;p&gt;Small gusts of wind are hard enough to predict but we still have meteorologists
measuring distributed pressure readings to deliver broad weather patterns. The
cones and rods of the eye enable us to take in enough data to read, drive and
explore. Our vocal transmitters and receivers are tuned to receive the propagation of waves through air, enough to say “Hey” and hear the reply in the same ~16kHz frequency band. In fact several of these disruptions in air are beautiful to us and people devote their lives to shaping and grooming the production of their features. I’m talking about audio engineers, musicians, producers and writers.
This doesn’t stop at the ear - mechanical engineers study the characteristics of
physical vibration through materials and RF (radiofrequency) engineers study the
propagation of waves that require no medium, just like our eyes, but beyond our
own capacity to see. What are the tools used that unite all of these seemingly
disparate people?&lt;/p&gt;
&lt;h2&gt;Penny Fourier Thoughts?&lt;/h2&gt;
&lt;p&gt;When I look at a typical audio recording (can you tell me much about
&lt;a href=&quot;https://i.stack.imgur.com/x3mF3.jpg&quot;&gt;this&lt;/a&gt; image?) I just see chaos,
and the same goes for a radio signal. But sometimes, on certain music players,
the display is equipped with an EQ (equalizer). This contains a binned up view of different
&lt;em&gt;frequencies&lt;/em&gt;. Say you hear a large bass boom in the track, when that happens
the lower ends of the EQ light up. If the EQ is adjustable you can even feel and
hear the difference as you turn the knob. If these bins give us such a clear
picture, could we enhance our understanding by creating smaller and smaller bins
on the EQ? What if the bins were infinitely small? That is for what a French
mathematician and aid to Napoleon, &lt;a href=&quot;https://en.wikipedia.org/wiki/Joseph_Fourier&quot;&gt;Joseph
Fourier&lt;/a&gt;, laid the mathematical bedrock. He proposed that one can completely break down
a (periodic) function into component sine waves, each with their own frequency.
After some revisions from future mathematicians we are left with the Fourier
Transform, granting our minds the intuition our ears and eyes had all
along.&lt;/p&gt;
&lt;p&gt;Still, there is a long way to go from this different interpretation of a signal
to creating something amazing. So let’s start with the simplest wave to the ears
and eyes, the sine wave. Below we have a plot of a sine wave and its
corresponding Fourier Transform. FFT below means Fast Fourier Transform, it was an
algorithm later developed to accelerate the DFT (Discrete Fourier Transform).
What you will see and hear in various forms is an “A” note.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; matplotlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pyplot &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; plt
    &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; np
    &lt;span class=&quot;token comment&quot;&gt;#import winsound # if you are on windows&lt;/span&gt;
    
    two_pi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pi
    phase &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pi&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
    frequency &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;440&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# &quot;A&quot; note in Hz&lt;/span&gt;
    duration_ms &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# miliseconds&lt;/span&gt;
    snr_level_db &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    duration_s &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; duration_ms&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000.0&lt;/span&gt;
    sample_rate &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;44.1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# Hz or samples/second&lt;/span&gt;
    fig_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# Beeeeep&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;#winsound.Beep(frequency, duration_ms) # Beep(frequency in hz, duration in ms)&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;createCosineAudioSignal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; duration_s&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        two_pi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pi
        x_samples &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;duration_s&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        x_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_sample&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; x_sample &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; x_samples&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        cosine_signal &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cos&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;two_pi &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; frequency &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; time_el &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; phase &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; time_el &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; x_time&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cosine_signal&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_time&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;computeFourierTransformOfSingal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;signal_amplitudes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sample_rate_hz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        fft_signal &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fft&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;signal_amplitudes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        fft_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fft&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fftfreq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_samples&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; d&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;sample_rate_hz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fft_signal&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fft_freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    x_samples &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;duration_s&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    x_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_sample&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; x_sample &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; x_samples&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y_0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_time&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; createCosineAudioSignal&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;frequency&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; duration_s&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;figure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;figsize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;fig_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_time&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y_0&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;A-note in time and frequency&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xlabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Time (seconds)&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ylabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Magnitude&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;show&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    sp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fft&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y_0&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fft&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fftfreq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_samples&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; d&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;figure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;figsize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;fig_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sp&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xlabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Frequency (Hz)&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ylabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Magnitude&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xlim&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;xmax&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;frequency&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; xmin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;show&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ff834a2b7abc5d4fbba35dae157f7189/ae694/audio_0_1_0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.56962025316456%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABo0lEQVQoz31RzW7UMBjMiXfhBXgKthWlRUg8QMuppwokDi0HDrwbokC3hWXTbbXqbuKNs/Ff8tnx2l9lJ1kqVPUwGvv7xqMZOUHEJE3TF1LVx2smDtdMHPV4z2V9eDu/O/7x6+Ljz4vxh2/fzz9d/p6cVFx2Gt5ph7tS6igJhuuSfq2NRcIaLAQg4Q1SCbiKrJFK00EZLJWJ86DLWa/r3+jWYjTkVXmqzAZzDlBIbanUlnCwRGibc4ggPQeshLZbneiQMbDtxtloWJX0czBcCWgJB0+l9jkHX/QcZkR0nD/Yl8psdRlrvLHOJ0mSPGPV+lRqixlrWhLihzocYt1450MtwOLBbNAWQkd477vKZVmesaYdDJ9OI3SXeEgtwGcMfFUbj4g+GlJanHGwuGSNIRwcEeDyyDqikNqtgpEAF/d82P87V7VxiOiiYZZlXwS029/7H6F6qFQq/eg+oKo1bjauq3x5dfX8+nr2Tkj5knG+M5vN9imlu0Kq0WK5fPV3Oj0Yj8dv/0wmb25ubvcZ4ztSytE0TQ+CTio1ulss9ubz+et7+7GFzmebWdcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/ff834a2b7abc5d4fbba35dae157f7189/f058b/audio_0_1_0.png&quot;
        srcset=&quot;/static/ff834a2b7abc5d4fbba35dae157f7189/c26ae/audio_0_1_0.png 158w,
/static/ff834a2b7abc5d4fbba35dae157f7189/6bdcf/audio_0_1_0.png 315w,
/static/ff834a2b7abc5d4fbba35dae157f7189/f058b/audio_0_1_0.png 630w,
/static/ff834a2b7abc5d4fbba35dae157f7189/ae694/audio_0_1_0.png 850w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8bd0415c7a0e043d93500dabe9b5e00c/8bd7c/audio_0_1_1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 44.30379746835443%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABTElEQVQoz62R0UsCQRDGt6yXnnoqTLEEof836EEjouwpKpMksCjJzkLkiEAiDIooqKDovNu92dm7m4vVO7AwfemDj4/Zmf3NwjLGWMK27bxSykTEOiIav60UGl3uGiCloYb0+zPqSghRYYyxaSnldThGlqtCP6CRM57nORqYAICGPiAiJCJ/0GGUlkA/0HX4sx/Z0/eVUq8aOIOIMdAf3EjUf1FA1HthXMc5MEcR8F0DZxHx8j+BkwAQAz0aoiAgsgRSQH8qiIBvGjiFKJvxslGfMk6+531oIPv86tYEYGgLcLgruSNAcIjSldwWwB1Au8uB9/quFJG544JOx3ElWjZ/1LyJ8mljrnHTSW+Xjhabtw8LGzvlrNl5Tm7tHi6Z9y/JlbXNXL5QWF5dL+bOWu1U6bieOTi5yFQbZnq/ep6ptdqp4l4l27p7mv8GJxF8alzkWD4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;png&quot;
        title=&quot;png&quot;
        src=&quot;/static/8bd0415c7a0e043d93500dabe9b5e00c/f058b/audio_0_1_1.png&quot;
        srcset=&quot;/static/8bd0415c7a0e043d93500dabe9b5e00c/c26ae/audio_0_1_1.png 158w,
/static/8bd0415c7a0e043d93500dabe9b5e00c/6bdcf/audio_0_1_1.png 315w,
/static/8bd0415c7a0e043d93500dabe9b5e00c/f058b/audio_0_1_1.png 630w,
/static/8bd0415c7a0e043d93500dabe9b5e00c/8bd7c/audio_0_1_1.png 845w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Feel free to adjust the frequency, amplitude and duration to kick the tires. As
you can see the frequency signal energy can be &lt;em&gt;mostly&lt;/em&gt; found at the generating
frequency. This I attribute to the imperfections of the discrete domain which
could have its own post. Also, you can rest assured about negative frequencies
(not shown here). If the original signal is real (and the sine wave is real…
whew) there should be a symmetrical graph about 0 Hz. Think of it like turning a wheel in a different direction (more info
&lt;a href=&quot;https://en.wikipedia.org/wiki/Negative_frequency&quot;&gt;here&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;At this point it is safe to say that we can design an algorithm to bin the
frequencies up and infer the signal from an input sine wave. Essentially
wherever there is more energy in the frequency plot is where we most likely to
find the frequency of our original wave. Our machine can listen to a perfect
beep and tell us what note it is. Great. Now, what if we recorded a guitar
plucking an A note? What if a truck is going by in the background of that
recording? How does our methodology hold up when we start approaching the
looming real world? Can we generate audio that sounds like the real world? I
hope to seek the answers to some of these questions in later posts.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    min_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16.35&lt;/span&gt;
    max_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;32.70&lt;/span&gt;
    
    note_to_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;C&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16.35&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;Cshp_Dflt&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17.32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;D&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18.35&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;Dshp_Eflt&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;19.45&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;E&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20.60&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;F&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21.83&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;Fshp_Gflt&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;23.12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;G&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;24.50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;Gshp_Aflt&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;25.96&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;A&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;27.50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;Ashp_Bflt&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;29.14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;B&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30.87&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;#&quot;C1&quot; : 32.70&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    
    freq_to_note &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;val&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;key &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; val &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; note_to_freq&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    base_freq_arr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;val &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; val &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; note_to_freq&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    freq_arr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;val&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;mult&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; mult &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; val &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; note_to_freq&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getHighestEnergyFreq&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;amp_list&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; freq_list&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbosity&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# We only care about positive frequencies which are the first half&lt;/span&gt;
        amp_freq_list &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;amp_list&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; freq_list&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
        &lt;span class=&quot;token comment&quot;&gt;# Get max freq&lt;/span&gt;
        max_amp_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; amp_freq &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; amp_freq_list&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; amp_freq&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; max_amp_freq&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                max_amp_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; amp_freq
                
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; verbosity &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Frequncy with most amplitude: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_amp_freq&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; max_amp_freq&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getBaseFreqFromSingalFreq&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;starting_frequency&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbosity&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;reduce the frequency to base frequency&quot;&quot;&quot;&lt;/span&gt;
        target_base_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; starting_frequency
        &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; target_base_freq &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            target_base_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; target_base_freq &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
            
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; verbosity &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Base Frequeuncy: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;target_base_freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; target_base_freq
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;takeClosest&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myList&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; myNumber&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; bisect &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; bisect_left
        
        pos &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; bisect_left&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myList&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; myNumber&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; pos &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; myList&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; pos &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myList&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; myList&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        before &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; myList&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pos &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        after &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; myList&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;pos&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; after &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; myNumber &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; myNumber &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; before&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; after
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; before
        
    sp_highest_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; getHighestEnergyFreq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sp&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; freq&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbosity&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    closest_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; takeClosest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; getBaseFreqFromSingalFreq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sp_highest_freq&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbosity&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Closest Note Frequency to Base Freq: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;closest_freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Determined Note: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; freq_to_note&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;closest_freq&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Frequncy with most amplitude: 440.0
Base Frequeuncy: 27.5
Closest Note Frequency to Base Freq: 27.5
Determined Note: A&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, I was kind of stuck back there. We can very clearly see in the Frequency
plot where the peak frequency is. How can we programatically look at that and
say “A”? One easy way that came to mind is to select the frequency with the
maximum amplitude. This works for now, as seen above. When the picture looks
that clear we could have done things such as count the y = 0 axis crossings of
the signal over time, but take a look below and you’ll see that time-domain
(signals where the independant variable is time) visual guessing of the
frequency will not work out in high noise situations.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;addAwgNoiseToSignal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_discr_signal&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; snr_dB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Calculates signal power and generates additive white gaussian noise to match SNR param&quot;&quot;&quot;&lt;/span&gt;
        sigp_dB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log10&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;linalg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;norm&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_discr_signal&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;\
                             &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_discr_signal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        noisep_dB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sigp_dB &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; snr_dB
        noisep &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;noisep_dB&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        noise &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sqrt&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;noisep&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;np&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;random&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;randn&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_discr_signal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;sig &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; noise &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sig&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;noise&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_discr_signal&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; noise&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    
    
    &lt;span class=&quot;token comment&quot;&gt;# Construct a new signal based off y_0 but with added noise to match the snr&lt;/span&gt;
    y_1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; addAwgNoiseToSignal&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y_0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;figure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;figsize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;fig_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x_time&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y_1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;A-note in time&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xlabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Time (seconds)&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ylabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Magnitude&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;show&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/7b17a0f8f1370fa1529624a738c5f4ba/bad1b/audio_0_5_0.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 46.202531645569614%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACe0lEQVQoz0WRS0wTURSGR0HQ+EjEhOjCBBWMhrA37jRucGmgQLAGHws1MdrGIBSCxJULXbhRceEjEhUTEQ0gG+MTSh8CUqBCaTtAW9B2Op323pnp3McxMwguTnLO+f+b8998wpbNxRslSWrUVLVZ11RHDiEnxtiqtJJ1qqrmWF5OuILBmVvxRMJlzqamqtiJEHaqq14HwrhZluVGQRA2FOmaOqsZFLJaHgA4EEqBMQYGoZA3KBiUgcE4GIRZep5Q0I3/HkLNPYCmaXNCyY6thbquj7rDEngikp5GeTIVzxBfVCKh3zmrJJQnYgqRWFol03HF0r+HkmR2JUsmYxniE6V8cDkLqqZ7hGOH9xTlsOp19ExA02MPvfJijDc8cvNzT7zc1TvJO/oCvOXNT3799QTveBfg9V1u7uwZ57aHI/xy9w9+9eUYP3nvK7vwzAcKUv1Ceen2kgzSRk/c/QxlLf30QOsAVLgGoexGP1R1DkFlxxCUuwagom1wva+6OQQH2wZhf+sAHGr/AKWOPnb09keQc9gvNBzZV5zMIG9r7yScf+ql5tVrr8b58TufeF3XCD91f5hffO63El/q9vPO91NWMjN9zYNhK/nZJ17a/jYAnBp+oXLvrk3ml8NJBL6oZESSiM2uZNmXuT9sKq4wdzjFpuMKC8QyTExhlpBV9i2UXN+tKBrzRCQipjAAIz5h985tRQjjSYOuEjTJUcYskmuzmidg/CO5Rl4ziOWjlFm9ST2v6wGhsKCgIDQ/Xx1PJM7kEKqR0ul6cWHBLmcUWy6HbItLS6fnwxH7TPBXUzgStS8uxRoxQrWKotiiomiXZbkOY1xrvhdFsfovgRQ5bJ9prr0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Noisy Signal&quot;
        title=&quot;Noisy Signal&quot;
        src=&quot;/static/7b17a0f8f1370fa1529624a738c5f4ba/f058b/audio_0_5_0.png&quot;
        srcset=&quot;/static/7b17a0f8f1370fa1529624a738c5f4ba/c26ae/audio_0_5_0.png 158w,
/static/7b17a0f8f1370fa1529624a738c5f4ba/6bdcf/audio_0_5_0.png 315w,
/static/7b17a0f8f1370fa1529624a738c5f4ba/f058b/audio_0_5_0.png 630w,
/static/7b17a0f8f1370fa1529624a738c5f4ba/bad1b/audio_0_5_0.png 841w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We took the same signal and just garbagized it. Now, this is a lot more noise
than we would typically see in an audio setting because our noise is now twenty
times larger than our signal. Do you think we’ll be able to see the signal using
a fourier transform?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;F_y_1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computeFourierTransformOfSingal&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y_1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x_samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sample_rate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    Fy1_highest_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; getHighestEnergyFreq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;F_y_1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; freq&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbosity&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    closest_freq &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; takeClosest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; getBaseFreqFromSingalFreq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Fy1_highest_freq&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; base_freq_arr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; verbosity&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Closest Frequency to Base Freq: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;closest_freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Determined Note: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; freq_to_note&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;closest_freq&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;figure&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;figsize&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;fig_size&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;F_y_1&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;A-note in Frequency with a ton of noise&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xlabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Frequency (Hz)&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ylabel&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Magnitude&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;xlim&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;xmax&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;frequency&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; xmin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    plt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;show&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Frequncy with most amplitude: 440.0
Base Frequeuncy: 27.5
Closest Frequency to Base Freq: 27.5
Determined Note: A&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4825db09aeeb351bc328bd5ea5af8c0b/8bd7c/audio_0_7_1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.56962025316456%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABk0lEQVQoz3VRS24TQRCdA3AjLoDEMgkYIbHIPhFSwg6fCMKCLVfwkpixlCi2R9jg8Xhm+v+rKlTtMSQReVLpdXW9ft1dVRBRsd1uXxpjLrXWZ1rrc6XUubX2rK7ri9ls9rEsy/H36XT8oyzHvF6v1x+4zjrWcxhj3rdte1qwYd/33xCRAOBB8N4B0kVKsM+f0lprRTaUUn4ezjkiivcDESMgxk77CICRCONjDREFPuy9v8uGWuur4WY2eID9NmJnwpDj/wCD4bIoiuKZc/bTwZAeARDJhUS9DXl9wP12cMrt0MZmw6LrxZehHEMCDBGQmcG80/7vC7lmQ8LBJNcJEUxI1PRqmb/8q2mvdACKCYINCbRPsFMejE8gXYRW+8ycKxdzCBvZBKSN0CifbADqpFkMPVRfbUgkbaA0TCylf+wjkIuQp6wd9x9JGE8xpTxhH9NeY+3vbHhze/tcCTH6WS1GQoij+Xz+Rog+s5TyaHp9/W4ymZwyi747rqpqVNebV5vN5mS1Wr3eNc1xtVy8bdv2xR+DdJQsiFC4wgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;DFT of Noisy Signal&quot;
        title=&quot;DFT of Noisy Signal&quot;
        src=&quot;/static/4825db09aeeb351bc328bd5ea5af8c0b/f058b/audio_0_7_1.png&quot;
        srcset=&quot;/static/4825db09aeeb351bc328bd5ea5af8c0b/c26ae/audio_0_7_1.png 158w,
/static/4825db09aeeb351bc328bd5ea5af8c0b/6bdcf/audio_0_7_1.png 315w,
/static/4825db09aeeb351bc328bd5ea5af8c0b/f058b/audio_0_7_1.png 630w,
/static/4825db09aeeb351bc328bd5ea5af8c0b/8bd7c/audio_0_7_1.png 845w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;How could this be? The real reason is that when we add “white” noise, we are
adding noise enery that is distributed across the frequency spectrum. So even
though the signal is 20 times weaker than the noise, if we know where to look,
we will find the signal in an even (white) noise distribution. Nosie isn’t
always white and sometimes noise can look a lot like our signal of interest. And
that is someting we can explore at another time.&lt;/p&gt;</content:encoded></item></channel></rss>